SELECT v.name, r.pitchtype, CORR(v.force_asym_val, r.horzbreaktraj), CORR(v.force_asym_val, r.vertbreaktraj), CORR(v.force_asym_val, r.velocity), COUNT(*)
FROM vald_t v JOIN rapsodo_pitches_t2 r ON v.name = r.name AND v.date BETWEEN DATE(r.datetime) - INTERVAL '3 days' AND DATE(r.datetime) + INTERVAL '3 days'
WHERE v.force_asym_val IS NOT NULL AND r.horzbreaktraj IS NOT NULL AND r.vertbreaktraj IS NOT NULL AND r.velocity IS NOT NULL AND v.movement = 'External Rotation' AND v.type = 'Strength'
GROUP BY v.name, r.pitchtype HAVING COUNT(*) > 30;

name             |pitchtype      |corr                  |corr                 |corr                  |count|
-----------------+---------------+----------------------+---------------------+----------------------+-----+
Josh Newell      |Splitter       | -0.043618152132982736|  0.16955393015463127|   0.15492274750988036|   36|
Brendan Ealy     |Fastball       | -0.032778746835637744|  0.33671054861823324|  -0.12007817482710553|  130|
Brendan Ealy     |Slider         |  -0.20889827686886192|-0.019566102034009825|    0.1736488919794687|   69|
Brendan Ealy     |ChangeUp       | -0.004308947940189679|  0.21190669825069916| -0.004634151134249047|   35|
Easton Rakers    |Fastball       |   0.21022346580102852| -0.35752406014051785|  -0.30533508486717753|  146|
Bennett Stice    |TwoSeamFastball|    0.6423065938145928|  -0.6048813032472081|   -0.6711883459933803|   39|
Carson Subbert   |Slider         |    0.0639323237644741|   0.0210527669025435|    0.0108917398318119|  398|
Bennett Stice    |Slider         |   0.04897050822699517|  -0.2784086358307743|   0.28649139237034205|   34|
Kris Alcorn      |Slider         |  -0.08796794174659124|  -0.1350305483818158|  0.058597547116568546|  193|
Eli Tritinger    |Slider         |    0.5677308158074228| 0.056271328620244275|   0.23309334894176942|  111|
Eli Brown        |ChangeUp       |   0.49831220001203774|   0.1887037549489492|   0.19156865101139628|  207|
Jack Fishel      |CurveBall      |   0.17245897530563306| -0.10003958343931159|   0.05948486408846755|   39|
Jack Fishel      |ChangeUp       |   0.03819606000566393|  0.06542114316205941| -0.005317618909240974|  157|
Dillon Haftorson |Slider         |-0.0031108003595970574|   -0.595001673667295|  -0.29040816530272706|  244|
Ethan Smith      |Cutter         |   0.22422719074994008| -0.24197338118564865|  -0.23039476409397283|  149|
Eli Tritinger    |ChangeUp       |   -0.8232463802955007|  0.25110867678434146|  -0.49746659911158353|   61|
Josh Newell      |Cutter         |  -0.19642141616838055|   0.2951022144589299|    0.5026359096501328|  124|
Zach Buschschulte|Slider         |  -0.05518280607401805| -0.21241677673600998|  -0.22740446977962867|  294|
Eli Tritinger    |Fastball       |   -0.5955568830518253|-0.031551534824658244|    0.3641447521147756|  290|
Jackson Parrill  |Fastball       |    0.2597084054429178|  0.01497371038305169|    0.3818796835738821|  498|
Easton Rakers    |Slider         | -0.021608471266592988|  0.11384441390458878|    0.2808637871341009|   66|
Matt James       |Fastball       |   -0.1236708892886459| -0.24318525505374464|   -0.1990027860153693|  325|
Eli Brown        |CurveBall      |   0.34066375431723583| -0.19433814004998942|-0.0055287888545061505|   98|
Eli Woodall      |CurveBall      |    0.5504733447610999|   0.5189954633469289|   0.31690898473543655|   42|
Tanner Paschke   |Cutter         |   -0.1202476970642383| -0.08724637517580808|  -0.14833655985152708|   73|
Ryan Sell        |CurveBall      |   -0.5435083810302551|   0.7242708966964124|    0.5938443928007766|   40|
Jackson Parrill  |Slider         |  -0.12145266683356838|  0.20755827402262564|   0.01704049175137919|   88|
Matt James       |ChangeUp       |    -0.141194456628515|  0.01051294749804029| -0.025044128493858356|   74|
Josh Newell      |Slider         | -0.025590539971543404|   0.0861230829952699|    0.5785665639098675|  213|
Matt James       |Slider         |    0.2613317435003422|  -0.2341348938887155|   0.10370865009826323|   78|
Zach Buschschulte|Cutter         |  0.025277014333029323|  0.14910962873437167| -0.006438943413893618|   69|
Ryan Sell        |Fastball       |     0.673253804613524|    0.622856534381042|  -0.12426084593700729|  237|
Noah Cryns       |Slider         |    -0.352665876799467|  0.24784810567545507|    0.1654425663340124|   67|
Carson Subbert   |Fastball       |   0.02024034840879922| -0.20428899958836844|  0.024921352795209753|  614|
Eli Woodall      |Fastball       |   -0.3125543979570237|   0.4260906176738338|    0.1809012157154344|   92|
Josh Newell      |Fastball       |  -0.10427944986664277| -0.11088055542078919|    0.2583393659006025|  537|
Kris Alcorn      |CurveBall      |   0.08504517690112577|   -0.312555136040256|  0.003850712968928018|   35|
Bennett Stice    |Cutter         |   0.22447592540297345| -0.42458743088955186|   -0.5625127324810918|   93|
Michael Walsh    |Slider         |    0.2052727507402886|  0.27421697980812004|   0.08862300754199576|   56|
Kris Alcorn      |Fastball       |  -0.09661100153881556|   0.1745478190460688|    0.3063099129466692|  666|
Jack Fishel      |Fastball       |  -0.44065829192554407|   0.7121025415281284|    0.4406853722711292|  140|
Noah Cryns       |Fastball       | -0.008593721312038997|   0.7591038767714048|     0.566021632120467|  154|
Ethan Smith      |ChangeUp       |  -0.10992917789845259| -0.07870640485086433|  -0.14062599637834033|   52|
Michael Walsh    |Fastball       |  -0.05484708243753911| -0.45639327957681797|    -0.445540382417379|  124|
Josh Newell      |ChangeUp       |  -0.19957200274983072|  -0.2440294403491335|   0.15776142554659833|  232|
Tanner Paschke   |Slider         |  -0.09389496805884082| -0.11294721118923297|   -0.0345448675403428|   55|
Jack Fishel      |Slider         | -0.029124537560252243|   0.3381340758029465|    0.1724220999742213|   42|
Jackson Parrill  |ChangeUp       |   0.21050051665303554|  -0.1244535650829268|   0.07151799082964615|  122|
Ryan Sell        |ChangeUp       |    0.6924012994439965|   0.2646750545103581|  -0.03384431165749062|   58|
Michael Walsh    |Cutter         |  -0.26346173345117324|  -0.2414507372517752|  -0.33302817964293047|  162|
Kris Alcorn      |ChangeUp       |  -0.04594753239224134| 0.009320774875330999|  -0.18465713337846043|  104|
Aaron Jungers    |Slider         |    0.3269380381437201|  -0.3359528886210171|  -0.12424811762773855|   60|
Eli Brown        |Fastball       |   0.28434163725421163|-0.025960697936027365|  0.029494985352444145|  422|
Eli Brown        |Slider         |   0.44128571505508674| -0.03178150663433271|   0.09880420435653049|  157|
Tanner Paschke   |Fastball       |  0.040301012480923736| -0.19405265139553812|  -0.09977122408933457|  257|
Aaron Jungers    |ChangeUp       |  -0.03482410043001995|  0.10051552344980974|   -0.3004819837656909|  142|
Zach Buschschulte|ChangeUp       |   0.44183090545327364| -0.33482868818586004|   0.17447491458907724|   85|
Aaron Jungers    |Fastball       | -0.022369749708024182| -0.11245948966466487|   0.20587787351796955|  135|
Ethan Smith      |Fastball       |   0.12779759819464892| -0.13308649992140206| -0.005459353030770983|  804|
Dillon Haftorson |ChangeUp       |    0.3276212632772202| -0.09226000913872244|   -0.4989341933650531|   70|
Easton Rakers    |ChangeUp       |    0.2802106222442335| -0.19263817057121502| -0.029586802107890293|  213|
Dillon Haftorson |Fastball       |  -0.07537643034404863| -0.11195772890866316|  -0.14601309611790136|  586|
Zach Buschschulte|Fastball       |    0.3380181237455832|  0.02475041493369323|  0.016585762987783827|  659|
Brendan Ealy     |CurveBall      |  -0.36218094270782936|  0.02671994347314703|   0.03087350168438202|   66|
Ethan Smith      |Slider         |   0.26320820240208337| -0.11261291556506789|   -0.2587498324412835|  191|
Tanner Paschke   |CurveBall      |   0.13458431139390767| -0.37919888698026183|   0.08426556801778949|  213|
